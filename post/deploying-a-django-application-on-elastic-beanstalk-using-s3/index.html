<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    

    
      <link href='https://fonts.googleapis.com/css?family=Open+Sans:400|Old+Standard+TT:400' rel='stylesheet' type='text/css'>
    

    <link rel="icon" type="image/png" href="/favicon_16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon_32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon_128x128.png" sizes="128x128">

    <link href="https://fonts.googleapis.com/css?family=Passion+One" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cardo:400,400i,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700" rel="stylesheet">

    <title>
      
      
         Deploying a Django application on Elastic Beanstalk using S3 
      
    </title>
    <link rel="canonical" href="https://kirang89.github.io/kirang.in/post/deploying-a-django-application-on-elastic-beanstalk-using-s3/">

    <style>
  * {
    border:0;
    font:inherit;
    font-size:110%;
    vertical-align:baseline;
    margin:0;
    padding:0;
    color: #333332;
    text-decoration-skip: ink;
    ext-rendering: optimizeLegibility;
    -moz-osx-font-smoothing: grayscale;
    -moz-font-feature-settings: "liga" on;
  }

  body {
    font-family:'PT Sans';
    font-weight: 500;
    line-height:160%;
    color:#333332;
    max-width:700px;
    margin:auto;
  }

  p {
    margin: 25px 0;
  }

  .entry-content a {
    font-size: 100%;
    text-decoration: none;
    background-size: 1px 1em;
    box-shadow: inset 0 -0.175em white, inset 0 -0.2em #000000b3;
    display: inline;
  }

  a img {
    border:none;
  }

  img {
    margin: 10px auto 10px auto;
    max-width: 100%;
    display: block;
  }

  .left-justify {
    float: left;
  }

  .right-justify {
    float:right;
  }

  pre, code {
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
    background-color: #f7f7f7;
  }

  code {
    font-size: 80%;
    padding: 4px;
  }

  pre {
    margin-top: 0;
    word-wrap: normal;
    padding: 16px;
    overflow: auto;
    font-size: 72%;
    line-height: 1.4;
  }

  pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
  }

  pre code {
    display: inline;
    max-width: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
  }

  pre code::before,
  pre code::after {
    content: normal;
  }

  em,q,em,dfn {
    font-style:italic;
  }

  .sans,html .gist .gist-file .gist-meta {
    font-family:"Open Sans","Myriad Pro",Myriad,sans-serif;
  }

  .mono,pre,code,tt,p code,li code {
    font-family: 'Fira Mono', monospace;
  }

  .heading,.serif,h1,h2,h3,h4 {
    font-family:"Passion One";
  }

  strong {
    font-weight: 700;
    font-size: 100%;
    letter-spacing: -.003em;
  }

  q:before {
    content:"\201C";
  }

  q:after {
    content:"\201D";
  }

  del,s {
    text-decoration:line-through;
  }

  blockquote {
    font-family:"Old Standard TT",serif;
    text-align:center;
    padding:50px;
  }

  blockquote p {
    display:inline-block;
    font-style:italic;
  }

  blockquote:before,blockquote:after {
    font-family:"Old Standard TT",serif;
    content:'\201C';
    font-size:35px;
    color:#403c3b;
  }

  blockquote:after {
    content:'\201D';
  }

  hr {
    width:40%;
    height: 1px;
    background:#403c3b;
    margin: 25px auto;
  }

  h1 {
    font-size:35px;
  }

  h2 {
    font-size:28px;
  }

  h3 {
    font-size:28px;
    margin-top: 20px;
    margin-bottom: 20px;
  }

  h1 a,h2 a,h3 a {
    text-decoration:none;
  }

  h1,h2 {
    margin-top:28px;
  }

  #sub-header, time {
    color:#403c3b;
    font-size:13px;
  }

  #sub-header {
    margin: 0 4px;
    margin-top: -15px;
  }

  #nav h1 a {
    font-size:35px;
    color:#1d1313;
    line-height:120%;
  }

  .posts_listing a,#nav a {
    text-decoration: none;
  }

  li {
    margin-left: 20px;
  }

  ul li {
    list-style-type: none;
    margin-left: 30px;
    font-size: 100%;
    margin-bottom: 14px;
  }

  ul li:before {
    content: '\2022';
    padding-right: 15px;
  }

  #nav ul li:before, .posts_listing li:before {
    content:'';
    margin-right:0;
  }

  #content {
    text-align:left;
    width:100%;
    font-size:15px;
    padding:60px 0 80px;
  }

  #content h1,#content h2 {
    margin-bottom:5px;
  }

  #content .entry-content {
    margin-top:30px;
    font-size: 135%;
    line-height: 158%;
    font-weight: 400;
    font-family: 'Cardo', Palatino;
  }

  #content h1 {
    line-height: 95%;
    font-weight: 500;
    text-transform: uppercase;
    font-size:52px;
    font-family: 'Passion One';
    color: black;
  }

  .entry-content h2 {
    font-size: 45px;
  }

  .entry-content h3 {
    font-size: 35px;
  }

  .entry-content h4 {
    font-size: 25px;
  }

  .highlight {
    margin: 10px 0;
    border: 1px solid #0000001a;
  }

  .posts_listing {
    margin:0 0 50px;
  }

  .posts_listing li {
    margin:0 0 0px 15px;
    line-height: 90%;
  }

  .posts_listing li a:hover,#nav a:hover {
    text-decoration: underline;
  }

  .posts_listing h2 {
    font-size: 28px;
    line-height: 95%;
  }

  .posts_listing #date {
    margin-top: 0px;
  }

  #nav {
    text-align:center;
    position:static;
    margin-top:60px;
  }

  #nav ul {
    display: table;
    margin: 8px auto 0 auto;
    background: #404040;
    font-weight: 900;
    font-family: 'Passion One', sans-serif;
    letter-spacing: 0.03em;
  }

  #nav li {
    list-style-type:none;
    display:table-cell;
    font-size:15px;
    padding: 0 20px;
  }

  #nav ul li a {
    color: white;
    text-transform: uppercase;
    letter-spacing: .05em;
  }

  #links {
    margin: 50px 0 0 0;
  }

  #links :nth-child(2) {
    float:right;
  }

  #not-found {
    text-align: center;
  }

  #not-found a {
    font-family:"Old Standard TT",serif;
    font-size: 200px;
    text-decoration: none;
    display: inline-block;
    padding-top: 225px;
  }

  #date {
    margin-top: -5px;
  }

  .note {
    background-color: #F0F7FB;
    padding: 0.5em;
    border-left: 2px solid #3498DB;
  }

  @media (max-width: 750px) {
    body {
      padding-left:20px;
      padding-right:20px;
    }

    #nav h1 a {
      font-size:28px;
    }

    #nav li {
      font-size:13px;
      padding: 0 15px;
    }

    #content {
      margin-top:0;
      padding-top:50px;
      font-size:14px;
    }

    #content h1 {
      font-size:45px;
    }

    #content h2 {
      font-size:22px;
    }

    .posts_listing li div {
      font-size:12px;
    }
  }

  @media (max-width: 400px) {
    body {
      padding-left:20px;
      padding-right:20px;
    }

    #nav h1 a {
      font-size:22px;
    }

    #nav li {
      font-size:12px;
      padding: 0 10px;
    }

    #content {
      margin-top:0;
      padding-top:20px;
      font-size:12px;
    }

    #content h1 {
      font-size:35px;
    }

    #content h2 {
      font-size:18px;
    }

    .posts_listing li div{
      font-size:12px;
    }
  }
</style>


    
  </head>

  <body>
    <section id=nav>
      <h1><a href="/">KG – Hacks. Thoughts. Writings.</a></h1>
      <ul>
        
          <li><a href="/kirang.in/about">About</a></li>
        
          <li><a href="https://github.com/kirang89">Code</a></li>
        
          <li><a href="#">Resume</a></li>
        
      </ul>
    </section>


<section id=content>
  <h1> Deploying a Django application on Elastic Beanstalk using S3 </h1>

  
    <div id=sub-header>
      August 2013 · 3 minute read
    </div>
  

  <div class="entry-content">
    <p>This post was born out of the pain to get a sample django application,
configured properly, using Amazon S3 for serving static files, to  run
on AWS Elastic Beanstalk. I encountered many errors on the way, but
finally managed to get a full fledged application running successfully.
I am gonna try and highlight the key steps here to help you get your
project up and running in no time.</p>

<p>First, create a sample Django project
and a AWS Elastic Beanstalk environment for your application, as per the
instructions provided in the <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_Python_django.html">official AWS
documentation</a>.</p>

<p>Once you&rsquo;ve successfully deployed a dummy application to AWS Elastic
Beanstalk, you need to configure the application to let S3 take care of
serving the static files. One important point to remember here is that
Django expects your webserver to serve static files in production mode
(<code>DEBUG = False</code>) and thus will not handle it on it&rsquo;s own, unlike in
development mode. Understanding this is critical to a successful
deployment.</p>

<p>So now let&rsquo;s go ahead and add S3 support. First you need to add the
following dependencies to your requirements.txt:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install django-storages boto
pip freeze | grep django-storages &gt;&gt; requirements.txt
pip freeze | grep boto &gt;&gt; requirements.txt</code></pre></div>
<p>Next, add <strong>storages</strong> to <span
class="lang:default highlight:0 decode:true crayon-inline">INSTALLED_APPS</span>  in
your settings file:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">INSTALLED_APPS = (
    <span style="color:#d20;background-color:#fff0f0">&#39;django.contrib.auth&#39;</span>,
    <span style="color:#d20;background-color:#fff0f0">&#39;django.contrib.contenttypes&#39;</span>,
    <span style="color:#d20;background-color:#fff0f0">&#39;django.contrib.sessions&#39;</span>,
    <span style="color:#d20;background-color:#fff0f0">&#39;django.contrib.sites&#39;</span>,
    <span style="color:#d20;background-color:#fff0f0">&#39;django.contrib.messages&#39;</span>,
    <span style="color:#d20;background-color:#fff0f0">&#39;django.contrib.admin&#39;</span>,
    <span style="color:#d20;background-color:#fff0f0">&#39;storages&#39;</span>,
)</code></pre></div>
<p>Now we need to provide AWS credentials and the bucket name to allow AWS
Elastic Beanstalk to transfer files to S3.  Add the following
configuration to <span
class="lang:default highlight:0 decode:true crayon-inline">settings.py</span> :</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#080;font-weight:bold">if</span> <span style="color:#080">not</span> DEBUG:
    AWS_STORAGE_BUCKET_NAME = <span style="color:#d20;background-color:#fff0f0">&#39;&lt;s3 bucket name&gt;&#39;</span>
    AWS_ACCESS_KEY_ID = <span style="color:#d20;background-color:#fff0f0">&#39;&lt;access key id&gt;&#39;</span>
    AWS_SECRET_ACCESS_KEY = <span style="color:#d20;background-color:#fff0f0">&#39;&lt;secret access key&gt;&#39;</span>
    STATICFILES_STORAGE = <span style="color:#d20;background-color:#fff0f0">&#39;storages.backends.s3boto.S3BotoStorage&#39;</span>
    S3_URL = <span style="color:#d20;background-color:#fff0f0">&#39;http://</span><span style="color:#33b;background-color:#fff0f0">%s</span><span style="color:#d20;background-color:#fff0f0">.s3.amazonaws.com/&#39;</span> % AWS_STORAGE_BUCKET_NAME
    STATIC_URL = S3_URL</code></pre></div>
<p>The <span
class="lang:default highlight:0 decode:true crayon-inline">STATICFILES_STORAGE</span>  setting
tells our application to use S3 for storing our static files.</p>

<p>The last step is to configure <span
class="lang:default highlight:0 decode:true crayon-inline">STATIC_ROOT</span> * *to
create a static directory in the root folder of your project. To do
that, add the following lines to your settings:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">os</span>

STATIC_ROOT = os.path.join(
                  os.path.dirname(
				      os.path.dirname(
					      os.path.abspath(__file__)
					  )
	              ),
				  <span style="color:#d20;background-color:#fff0f0">&#39;static&#39;</span>
			  )</code></pre></div>
<p>That&rsquo;s it ! When you run the application on AWS Elastic Beanstalk,
the <code>03_collectstatic</code> command that you added to the ebs
configuration file, will collect the static files from all your
applications and then add them to the static folder created at
STATIC_ROOT. This folder is then deployed to S3 and voila ! All your static files will now be served from the Amazon S3 server.</p>

<p>Hope you got your application running without any hassles. If you still
have difficulties following this tutorial, you can check out
<a href="https://github.com/kirang89/djangoboilerplate">djangoboilerplate</a>, a
boilerplate application fully configured and ready for deployment.</p>

  </div>

  <div id=links>
    
      <a class="basic-alignment left" href="https://kirang89.github.io/kirang.in/post/jvm-profiling-disclosures/">&laquo; JVM Profiling Disclosures</a>
    
    
      <a class="basic-alignment left" href="https://kirang89.github.io/kirang.in/post/familiarising-yourself-with-a-large-codebase/">Familiarising yourself with a large codebase &raquo;</a>
    
  </div>
</section>

  
</body>
</html>



